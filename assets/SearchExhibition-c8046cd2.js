import{r as k,e as I,u as B,a as Q,o as K,w as L,b as c,c as i,d as e,n as u,f as d,F as P,g as $,h as W,t as p,i as j,j as n,k as S}from"./index-17ba43ee.js";const H={class:"d-flex"},U={class:"w-100 mb-2 d-block d-md-none"},T=e("span",null," Close",-1),R=["checked"],z=e("p",{for:"date-valid",class:"pb-1"}," 顯示已結束展覽 ",-1),N={class:"mb-3"},O=e("p",{class:"fw-bold mb-2"},"類型",-1),G={class:"type-list rounded-3 border mb-1"},J={class:"border-bottom p-2"},X=["checked"],Y=e("span",{for:"type-all"},"全部",-1),Z=["onClick"],ee=["id","value","checked"],te=["for"],le={class:"d-flex px-1"},ae={class:"mb-2"},oe=e("p",{class:"fw-bold mb-2"},"展覽期間",-1),se=e("p",{class:"mb-2 fw-bold"},"價格",-1),ne={class:"d-flex flex-column"},re=e("p",{class:"mb-1 fs-7"},"最小票價",-1),ie={key:1,class:"errorMessage"},de={class:"d-flex flex-column"},ce=e("p",{class:"mb-1 fs-7"},"最大票價",-1),ue={key:1,class:"errorMessage"},pe={class:"fs-7 mb-2 fw-bold"},ve={class:"city-list border rounded-3"},ye={class:"p-2 border-bottom"},_e=["checked"],me=e("span",{for:"all"},"全部",-1),be=["onClick"],he=["id","value","checked"],fe=["for"],ke={class:"container position-relative px-3"},xe={class:"border"},ge=e("p",null,"開發資料",-1),De=e("div",{class:"my-4 rounded-3"},[e("div",null,[e("input",{class:"border rounded-1 px-2 py-1",type:"search",placeholder:"輸入展覽名稱",name:"",id:""})])],-1),Ve=e("span",null," 篩選器",-1),we=e("p",null,null,-1),$e={__name:"SearchExhibition",setup(Ce){const A=o=>{o.preventDefault()},v=k(I()),_=B(),M=Q(),m=k(!1),w=()=>{m.value=!m.value},x=["臺北","新北","桃園","臺中","臺南","高雄","新竹","苗栗","彰化","南投","雲林","嘉義","屏東","宜蘭","花蓮","臺東","澎湖","金門","連江","基隆"],s=k({typeArr:[],cityArr:x,cityKeyWord:"",typeQuantity:5}),l=k({dateValid:!1,type:"all",startDate:0,endDate:new Date().getTime()+365*24*60*60*100,minPrice:1,maxPrice:1e5,city:"all"});K(async()=>{v.value.exhibitionList.length===0&&await v.value.getAllExhibitionData(),F(),console.log("[BeforeMount]",v.value.exhibitionList),console.log("[BeforeMount]",_.query),L(l.value,()=>{typeof l.value.startDate=="object"&&(l.value.startDate=new Date(l.value.startDate).getTime()),typeof l.value.endDate=="object"&&(l.value.endDate=new Date(l.value.endDate).getTime()),M.replace({name:"SearchExhibition",query:l.value})})});const F=()=>{if(s.value.typeArr=Array.from(new Set(v.value.exhibitionList.map(o=>o.type))),Object.keys(_.query).length>0){const{dateValid:o,type:a,startDate:g,endDate:b,minPrice:h,maxPrice:f,city:D}=_.query,V={dateValid:o==="true",type:a,startDate:parseInt(g),endDate:parseInt(b),minPrice:parseInt(h),maxPrice:parseInt(f),city:D};l.value={...l.value,...V}}},y=(o,a)=>{console.log("click",o,a),l.value[`${o}`]=a,console.log("[fetch Data]",123)},q=o=>{o.preventDefault(),s.value.cityKeyWord=o.target.value,o.target.value===""&&(s.value.cityArr=x),console.log(s.value.cityArr.filter(a=>a.includes(o.target.value))),s.value.cityArr=x.filter(a=>a.includes(o.target.value))},C=o=>{switch(o){case"add":s.value.typeQuantity+=5;break;case"reset":s.value.typeQuantity=5;break}};return(o,a)=>{const g=c("CloseIcon"),b=c("DatePicker"),h=c("VeeField"),f=c("ErrorMessage"),D=c("VeeForm"),V=c("FilterMenu");return n(),i("div",H,[e("div",{class:u(`side border-end ${m.value?"w-0":"border-none"}`)},[e("div",{class:u(`m-4 ${m.value&&"d-none"}`)},[e("div",U,[e("button",{class:"btn border",onClick:w},[d(g),T])]),e("div",{onClick:a[0]||(a[0]=t=>y("dateValid",!l.value.dateValid)),class:"d-flex gap-2 align-items-center border-bottom pb-4 mb-4 px-3"},[e("input",{id:"date-valid",type:"checkbox",name:"checkbox",checked:l.value.dateValid},null,8,R),z]),e("div",N,[O,e("ul",G,[e("li",J,[e("div",{onClick:a[1]||(a[1]=t=>y("type","all"))},[e("input",{class:"me-2",id:"type-all",type:"radio",name:"type",value:"all",checked:l.value.type==="all"},null,8,X),Y])]),(n(!0),i(P,null,$(s.value.typeArr.slice(0,s.value.typeQuantity),(t,r)=>(n(),i("li",{class:"p-2 border-bottom",key:r},[e("div",{onClick:E=>y("type",t)},[e("input",{class:"me-2",id:t,type:"radio",name:"type",value:t,checked:l.value.type===t},null,8,ee),e("span",{class:"",for:t},p(t),9,te)],8,Z)]))),128))]),e("div",le,[e("button",{class:u(`border-0 bg-transparent fw-bold ${s.value.typeQuantity<6&&"d-none"}`),type:"button",onClick:a[2]||(a[2]=t=>C("reset"))}," 收回 ",2),e("button",{onClick:a[3]||(a[3]=t=>C("add")),class:u(`border-0 bg-transparent fw-bold ms-auto ${s.value.typeArr.length<5&&"d-none"}`),type:"button"}," 顯示更多 ",2)])]),e("div",ae,[oe,d(b,{modelValue:l.value.startDate,"onUpdate:modelValue":a[4]||(a[4]=t=>l.value.startDate=t),class:"mb-2",type:"number",placeholder:"開始時間"},null,8,["modelValue"]),d(b,{placeholder:"結束時間",modelValue:l.value.endDate,"onUpdate:modelValue":a[5]||(a[5]=t=>l.value.endDate=t)},null,8,["modelValue"])]),se,d(D,{onSubmit:A},{default:W(({errors:t})=>[e("div",ne,[re,d(h,{modelValue:l.value.minPrice,"onUpdate:modelValue":a[6]||(a[6]=r=>l.value.minPrice=r),class:u(`border rounded py-1 px-2 ${t.最小價格?"border-danger":"border"}`),placeholder:"最小價格",name:"最小價格",type:"number",oninput:"value=value.replace(/[^\\d]/g,'')",rules:{min_value:0,max_value:l.value.maxPrice,numeric:!0}},null,8,["modelValue","class","rules"]),t.最小價格?(n(),S(f,{key:0,as:"p",class:"text-danger errorMessage",name:"最小價格"})):(n(),i("p",ie))]),e("div",de,[ce,d(h,{modelValue:l.value.maxPrice,"onUpdate:modelValue":a[7]||(a[7]=r=>l.value.maxPrice=r),class:u(`border rounded py-1 px-2 ${t.最大價格?"border-danger":"border"}`),placeholder:"最大價格",name:"最大價格",type:"number",oninput:"value=value.replace(/[^\\d]/g,'')",rules:{min_value:l.value.minPrice,max_value:1e5,numeric:!0}},null,8,["modelValue","class","rules"]),t.最大價格?(n(),S(f,{key:0,as:"p",class:"text-danger errorMessage",name:"最大價格"})):(n(),i("p",ue))])]),_:1}),e("div",null,[e("p",pe,"城市 "+p(s.value.cityKeyWord),1),e("input",{onInput:q,class:"border w-100 rounded px-2 py-1 mb-2",type:"search",placeholder:"篩選城市名稱",name:"cityKeyWord",id:"cityKeyWord"},null,32),e("ul",ve,[e("li",ye,[e("div",{onClick:a[8]||(a[8]=t=>y("city","all"))},[e("input",{class:"me-2",id:"all",type:"radio",name:"city",value:"all",checked:l.value.city==="all"},null,8,_e),me])]),(n(!0),i(P,null,$(s.value.cityArr,(t,r)=>(n(),i("li",{class:"p-2 border-bottom",key:r},[e("div",{onClick:E=>y("city",t)},[e("input",{class:"me-2",id:t,type:"radio",name:"city",value:t,checked:l.value.city===t},null,8,he),e("span",{class:"",for:t},p(t),9,fe)],8,be)]))),128))])])],2)],2),e("div",ke,[e("div",xe,[ge,e("p",null,"req query 檢查資料 "+p(j(_).query),1)]),De,e("button",{class:"border position-absolute top-0 start-0",type:"button",onClick:w},[d(V),Ve]),e("p",null,"篩選器 "+p(l.value)+" 這裡需要設定 增加樣式",1),we,e("p",null,"展覽資料 "+p(v.value.exhibitionList.map(t=>t.name)),1)])])}}};export{$e as default};
